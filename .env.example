# ============================================================================
# Synthetic Consumer SSR API - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your values
# DO NOT commit .env to version control!

# ============================================================================
# Server Configuration
# ============================================================================
ENV=development  # development | staging | production
DEBUG=true
LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR | CRITICAL
LOG_FORMAT=json  # json | text
HOST=0.0.0.0
PORT=8000

# ============================================================================
# LLM API Keys (REQUIRED)
# ============================================================================
# OpenAI API key for GPT-4o and embeddings
OPENAI_API_KEY=your-openai-api-key-here

# Google API key for Gemini-2.0-flash
GOOGLE_API_KEY=your-google-api-key-here

# OpenAI Organization ID (optional)
OPENAI_ORG_ID=

# ============================================================================
# Database Configuration
# ============================================================================
# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://ssr_user:ssr_password@localhost:5432/ssr_db

# Individual database components (alternative to DATABASE_URL)
POSTGRES_USER=ssr_user
POSTGRES_PASSWORD=ssr_password
POSTGRES_DB=ssr_db
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# ============================================================================
# Redis Configuration
# ============================================================================
# Redis connection URL
# Format: redis://[:password@]host:port/db
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=

# ============================================================================
# Celery Configuration
# ============================================================================
TASK_QUEUE_BACKEND=redis  # memory | redis | celery
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0
MAX_CONCURRENT_TASKS=10
TASK_TIMEOUT_SECONDS=3600

# ============================================================================
# Security & Authentication
# ============================================================================
# API Keys (comma-separated for multiple keys)
API_KEYS=dev-key-12345,prod-key-67890

# JWT Configuration (future enhancement)
JWT_SECRET_KEY=your-jwt-secret-key-here
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=60

# CORS Configuration (comma-separated origins)
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=*
CORS_ALLOW_HEADERS=*

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000
RATE_LIMIT_REQUESTS_PER_DAY=10000

# Usage Quotas
QUOTA_ENABLED=true
QUOTA_DEFAULT_MONTHLY_SURVEYS=1000
QUOTA_DEFAULT_MONTHLY_RESPONSES=100000

# ============================================================================
# Monitoring & Observability
# ============================================================================
# Prometheus metrics
METRICS_ENABLED=true
METRICS_PORT=9090

# Sentry error tracking (production only)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_TRACES_SAMPLE_RATE=0.1

# Health check endpoint
HEALTH_CHECK_PATH=/health

# ============================================================================
# Feature Flags
# ============================================================================
# Demographics (CRITICAL for 90% reliability - keep enabled!)
ENABLE_DEMOGRAPHICS=true

# Multi-reference set averaging
ENABLE_MULTI_SET_AVERAGING=true

# Demographic bias detection
ENABLE_BIAS_DETECTION=true

# Reference statement quality metrics
ENABLE_QUALITY_METRICS=true

# ============================================================================
# Data Storage Paths
# ============================================================================
DATA_DIR=./data
CACHE_DIR=./data/cache
REFERENCE_SETS_DIR=./data/reference_sets
RESULTS_DIR=./data/results

# ============================================================================
# Cloud Provider Configuration (if deploying to cloud)
# ============================================================================

# AWS Configuration
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key
# AWS_REGION=us-east-1
# AWS_S3_BUCKET=ssr-data-bucket

# Google Cloud Configuration
# GOOGLE_CLOUD_PROJECT=your-project-id
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json
# GCS_BUCKET=ssr-data-bucket

# Azure Configuration
# AZURE_STORAGE_ACCOUNT=your-storage-account
# AZURE_STORAGE_KEY=your-storage-key
# AZURE_CONTAINER=ssr-data-container

# ============================================================================
# Performance Tuning
# ============================================================================
# Uvicorn workers (4 * CPU cores recommended)
UVICORN_WORKERS=4

# Celery worker concurrency
CELERY_WORKER_CONCURRENCY=8

# Celery max tasks per child (prevent memory leaks)
CELERY_MAX_TASKS_PER_CHILD=100

# ============================================================================
# Development Tools
# ============================================================================
# Enable Swagger/ReDoc UI (disable in production)
ENABLE_DOCS_UI=true

# Grafana admin password
GRAFANA_ADMIN_PASSWORD=admin

# ============================================================================
# Cost Optimization
# ============================================================================
# LLM request caching (save on API costs)
ENABLE_LLM_CACHING=true
LLM_CACHE_TTL_SECONDS=86400  # 24 hours

# Embedding caching
ENABLE_EMBEDDING_CACHING=true
EMBEDDING_CACHE_TTL_SECONDS=604800  # 7 days

# ============================================================================
# Compliance & Data Privacy
# ============================================================================
# Data retention period (days)
DATA_RETENTION_DAYS=90

# Enable audit logging
ENABLE_AUDIT_LOGGING=true

# Anonymize PII in logs
ANONYMIZE_PII=true
